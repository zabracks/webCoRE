(function(a){angular.module("ui.bootstrap.contextMenu",[]).service("CustomService",function(){return{initialize:function(b){console.log("got here",b)}}}).directive("contextMenu",["$parse","$q","CustomService","$sce",function(g,i,c,n){var l=[];var d="New Item";var m=function(o){while(l.length&&(!o||l.length>o)){l.pop().remove()}};var h=function(v,x,u,o,q,s,w,r){var p=r("<a>");p.css("padding-right","8px");p.attr({tabindex:"-1",href:"#"});if(typeof x[0]==="string"){u=x[0]}else{if(typeof x[0]==="function"){u=x[0].call(v,v,o,q)}else{if(typeof x.text!=="undefined"){u=x.text}}}var t=i.when(u);s.push(t);t.then(function(y){if(w){p.css("cursor","default");p.append(r('<strong style="font-family:monospace;font-weight:bold;float:right;">&gt;</strong>'))}p.append(y)});return p};var e=function(y,p,q,A,s,v,t,u,r,o){var z=angular.isArray(A[1])||(A[1]&&angular.isFunction(A[1].then))?A[1]:angular.isArray(A[2])||(A[2]&&angular.isFunction(A[2].then))?A[2]:angular.isArray(A[3])||(A[3]&&angular.isFunction(A[3].then))?A[3]:null;var x=d;if(typeof A[0]==="function"||typeof A[0]==="string"||typeof A.text!=="undefined"){x=h(y,A,x,p,q,t,z,r)}else{if(typeof A.html==="function"){x=A.html(y)}else{if(typeof A.html!=="undefined"){x=A.html}}}v.append(x);var w=function(){if(typeof A.enabled!=="undefined"){return A.enabled.call(y,y,p,q,x)}else{if(typeof A[2]==="function"){return A[2].call(y,y,p,q,x)}else{return true}}};b(y,w(),A,s,v,z,q,x,p,r,o)};var k=function(p,r,q,o){i.all(o).then(function(){var s=q.pageY;var u=angular.element(p[0]).prop("offsetHeight");var x=window.scrollY+q.view.innerHeight;if(s>u&&x-s<u+20){s=q.pageY-u;if(r&&r>0){s+=q.event.currentTarget.offsetHeight}}else{if(x<=u){angular.element(p[0]).css({height:x-5,"overflow-y":"scroll"});s=0}else{if(x-s<u){var z=5;if(s<z){z=s}s=x-u-z}}}var t=q.pageX;var y=angular.element(p[0]).prop("offsetWidth");var v=q.view.innerWidth;var w=5;if(t>y&&v-t-w<y){t=v-y-w}else{if(v-t<y){var A=5;if(t<A+w){A=t+w}t=v-y-A-w}}p.css({display:"block",position:"absolute",left:t+"px",top:s+"px"})})};var b=function(x,u,z,t,v,y,r,w,p,s,o){if(u){var q=function(A){m(o+1);var B={pageX:p.pageX+t[0].offsetWidth-1,pageY:t[0].offsetTop+v[0].offsetTop-3,view:p.view||window,event:A};i.when(y).then(function(C){j(x,B,C,r,o+1)})};v.on("click",function(A){if(A.which==1){A.preventDefault();x.$apply(function(){if(y){q(A)}else{s(p.currentTarget).removeClass("context");m();if(angular.isFunction(z[1])){z[1].call(x,x,p,r,w,v)}else{z.click.call(x,x,p,r,w,v)}}})}});v.on("mouseover",function(A){x.$apply(function(){if(y){q(A)}else{m(o+1)}})})}else{v.on("click",function(A){A.preventDefault()});v.addClass("disabled")}};var j=function(y,p,z,r,o,x){if(!o){o=0}a(p.currentTarget).addClass("context");var t=a("<ul>");t.addClass("dropdown-menu");t.attr({role:"menu"});t.css({display:"block",position:"absolute",left:p.pageX+"px",top:p.pageY+"px","z-index":10000});var u=[];angular.forEach(z,function(A){var B=a("<li>");if(A===null){B.addClass("divider")}else{if(typeof A[0]==="object"){c.initialize(B,A)}else{e(y,p,r,A,t,B,u,i,a,o)}}t.append(B)});var w=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);a(document).find("body").append(t);k(t,o,p,u);function v(A){q(A)}function s(C){var B=a(C.target);var A=true;while(B.length){if(B.hasClass("dropdown-menu")){A=false;break}else{B=B.parent()}}if(A){q(C)}}function q(A){a(document.body).off("mousedown",s);a(document).off("scroll",v);a(p.originalTarget).removeClass("context");m()}if(o===0){a(document.body).on("mousedown",s);a(document).on("scroll",v)}y.$on("$destroy",function(){m()});l.push(t)};function f(){return"ontouchstart" in window||navigator.maxTouchPoints}return function(o,r,q){var p="contextmenu";if(q.contextMenuOn&&typeof(q.contextMenuOn)==="string"){p=q.contextMenuOn}r.on(p,function(s){if(!q.allowEventPropagation){s.stopPropagation();s.preventDefault()}if(f()&&r.attr("draggable")==="true"){return false}o.$apply(function(){var u=o.$eval(q.contextMenu);var v=q.contextMenuClass;var t=o.$eval(q.model);if(u instanceof Array){if(u.length===0){return}j(o,s,u,t,undefined,v)}else{throw'"'+q.contextMenu+'" not an array'}})})}}])})(window.angular.element);